<!DOCTYPE html><html class=no-js lang=zh> <head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="Xiao Xu - Homepage" name=description><meta content="Xiao Xu" name=author><link href=https://looperxx.github.io/notes/CS224n-2019-18-Tree%20Recursive%20Neural%20Networks%2C%20Constituency%20Parsing%2C%20and%20Sentiment/ rel=canonical><link href=../CS224n-2019-17-Multitask%20Learning/ rel=prev><link href=../CS224n-2019-19-Safety%2C%20Bias%2C%20and%20Fairness/ rel=next><link href=../../assets/images/favicon.png rel=icon><meta content="mkdocs-1.5.3, mkdocs-material-9.4.2" name=generator><title>18 Tree Recursive Neural Networks, Constituency Parsing, and Sentiment - The Sun Also Rises.</title><link href=../../assets/stylesheets/main.d451bc0e.min.css rel=stylesheet><link href=../../assets/stylesheets/palette.a5377069.min.css rel=stylesheet><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback" rel=stylesheet><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href=../../stylesheets/extra.css rel=stylesheet><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-CV5JZHXZY8"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-CV5JZHXZY8",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-CV5JZHXZY8",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><link href=../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src=../../assets/javascripts/glightbox.min.js></script></head> <body data-md-color-accent=indigo data-md-color-primary=indigo data-md-color-scheme=default dir=ltr> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox> <input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a class=md-skip href=#lecture-18-tree-recursive-neural-networks-constituency-parsing-and-sentiment> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav aria-label=页眉 class="md-header__inner md-grid"> <a aria-label="The Sun Also Rises." class="md-header__button md-logo" data-md-component=logo href=../.. title="The Sun Also Rises."> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> The Sun Also Rises. </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 18 Tree Recursive Neural Networks, Constituency Parsing, and Sentiment </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input aria-label="Switch to dark mode" class=md-option data-md-color-accent=indigo data-md-color-media data-md-color-primary=indigo data-md-color-scheme=default id=__palette_1 name=__palette type=radio> <label class="md-header__button md-icon" for=__palette_2 hidden title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg> </label> <input aria-label="Switch to light mode" class=md-option data-md-color-accent=indigo data-md-color-media data-md-color-primary=indigo data-md-color-scheme=slate id=__palette_2 name=__palette type=radio> <label class="md-header__button md-icon" for=__palette_1 hidden title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input aria-label=搜索 autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=搜索 required spellcheck=false type=text> <label class="md-search__icon md-icon" for=__search> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </label> <nav aria-label=查找 class=md-search__options> <a aria-label=分享 class="md-search__icon md-icon" data-clipboard data-clipboard-text data-md-component=search-share href=javascript:void(0) tabindex=-1 title=分享> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"></path></svg> </a> <button aria-label=清空当前内容 class="md-search__icon md-icon" tabindex=-1 title=清空当前内容 type=reset> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a class=md-source data-md-component=source href=https://github.com/LooperXX/LooperXX.github.io title=前往仓库> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg> </div> <div class=md-source__repository> LooperXX/LooperXX.github.io </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav aria-label=标签 class=md-tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a class=md-tabs__link href=../..> Xiao Xu @ HIT-SCIR </a> </li> <li class=md-tabs__item> <a href=../../blog/ManagerTower/ class=md-tabs__link> Blogs </a> </li> <li class=md-tabs__item> <a href=../Normalization/ class=md-tabs__link> Notes </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../CS224n-2019-00-Info/ class=md-tabs__link> Notes on CS224n-2019 </a> </li> <li class=md-tabs__item> <a href=../MkDocs_demo/ class=md-tabs__link> Notes on MkDocs </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav aria-label=导航栏 class="md-nav md-nav--primary md-nav--lifted" data-md-level=0> <label class=md-nav__title for=__drawer> <a aria-label="The Sun Also Rises." class="md-nav__button md-logo" data-md-component=logo href=../.. title="The Sun Also Rises."> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg> </a> The Sun Also Rises. </label> <div class=md-nav__source> <a class=md-source data-md-component=source href=https://github.com/LooperXX/LooperXX.github.io title=前往仓库> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg> </div> <div class=md-source__repository> LooperXX/LooperXX.github.io </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../..> <span class=md-ellipsis> Xiao Xu @ HIT-SCIR </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_2 type=checkbox> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Blogs </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_2_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Blogs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../blog/ManagerTower/ class=md-nav__link> <span class=md-ellipsis> ACL 2023 Oral Paper | ManagerTower: 自适应融合单模态专家见解的视觉语言表示学习方法 </span> </a> </li> <li class=md-nav__item> <a href=../../blog/BridgeTower/ class=md-nav__link> <span class=md-ellipsis> AAAI 2023 Oral Paper | BridgeTower: 在视觉语言表示学习中建立编码器间的桥梁 </span> </a> </li> <li class=md-nav__item> <a href=../../blog/Profile%20SLU/ class=md-nav__link> <span class=md-ellipsis> AAAI 2022 Oral Paper | Profile SLU: 基于Profile信息的口语语言理解基准 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_3 type=checkbox> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Notes </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_3_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Notes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Normalization/ class=md-nav__link> <span class=md-ellipsis> Normalization </span> </a> </li> <li class=md-nav__item> <a href=../Transfer%20Learning/ class=md-nav__link> <span class=md-ellipsis> Transfer Learning </span> </a> </li> <li class=md-nav__item> <a href=../Attention/ class=md-nav__link> <span class=md-ellipsis> Attention </span> </a> </li> <li class=md-nav__item> <a href=../Neural%20Reading%20Comprehension%20and%20beyond/ class=md-nav__link> <span class=md-ellipsis> Machine Reading Comprehension </span> </a> </li> <li class=md-nav__item> <a href=../Notes%20on%20NCRF%2B%2B/ class=md-nav__link> <span class=md-ellipsis> NCRF++ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input checked class="md-nav__toggle md-toggle" id=__nav_4 type=checkbox> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Notes on CS224n-2019 </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=true aria-labelledby=__nav_4_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Notes on CS224n-2019 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../CS224n-2019-00-Info/ class=md-nav__link> <span class=md-ellipsis> CS224n-2019 Introduction </span> </a> </li> <li class=md-nav__item> <a href=../CS224n-2019-Assignment/ class=md-nav__link> <span class=md-ellipsis> CS224n-2019 Assignment </span> </a> </li> <li class=md-nav__item> <a href=../CS224n-2019-01-Introduction%20and%20Word%20Vectors/ class=md-nav__link> <span class=md-ellipsis> 01 Introduction and Word Vectors </span> </a> </li> <li class=md-nav__item> <a href=../CS224n-2019-02-Word%20Vectors%202%20and%20Word%20Senses/ class=md-nav__link> <span class=md-ellipsis> 02 Word Vectors 2 and Word Senses </span> </a> </li> <li class=md-nav__item> <a href=../CS224n-2019-03-Word%20Window%20Classification%2CNeural%20Networks%2C%20and%20Matrix%20Calculus/ class=md-nav__link> <span class=md-ellipsis> 03 Word Window Classification,Neural Networks, and Matrix Calculus </span> </a> </li> <li class=md-nav__item> <a href=../CS224n-2019-04-Backpropagation%20and%20Computation%20Graphs/ class=md-nav__link> <span class=md-ellipsis> 04 Backpropagation and Computation Graphs </span> </a> </li> <li class=md-nav__item> <a href=../CS224n-2019-05-Linguistic%20Structure%20Dependency%20Parsing/ class=md-nav__link> <span class=md-ellipsis> 05 Linguistic Structure Dependency Parsing </span> </a> </li> <li class=md-nav__item> <a href=../CS224n-2019-06-The%20probability%20of%20a%20sentence%20Recurrent%20Neural%20Networks%20and%20Language%20Models/ class=md-nav__link> <span class=md-ellipsis> 06 The probability of a sentence Recurrent Neural Networks and Language Models </span> </a> </li> <li class=md-nav__item> <a href=../CS224n-2019-07-Vanishing%20Gradients%20and%20Fancy%20RNNs/ class=md-nav__link> <span class=md-ellipsis> 07 Vanishing Gradients and Fancy RNNs </span> </a> </li> <li class=md-nav__item> <a href=../CS224n-2019-08-Machine%20Translation%2C%20Sequence-to-sequence%20and%20Attention/ class=md-nav__link> <span class=md-ellipsis> 08 Machine Translation, Sequence-to-sequence and Attention </span> </a> </li> <li class=md-nav__item> <a href=../CS224n-2019-09-Practical%20Tips%20for%20Final%20Projects/ class=md-nav__link> <span class=md-ellipsis> 09 Practical Tips for Final Projects </span> </a> </li> <li class=md-nav__item> <a href=../CS224n-2019-10-Question%20Answering%20and%20the%20Default%20Final%20Project/ class=md-nav__link> <span class=md-ellipsis> 10 Question Answering and the Default Final Project </span> </a> </li> <li class=md-nav__item> <a href=../CS224n-2019-11-ConvNets%20for%20NLP/ class=md-nav__link> <span class=md-ellipsis> 11 ConvNets for NLP </span> </a> </li> <li class=md-nav__item> <a href=../CS224n-2019-12-Information%20from%20parts%20of%20words%20Subword%20Models/ class=md-nav__link> <span class=md-ellipsis> 12 Information from parts of words Subword Models </span> </a> </li> <li class=md-nav__item> <a href=../CS224n-2019-13-Modeling%20contexts%20of%20use%20Contextual%20Representations%20and%20Pretraining/ class=md-nav__link> <span class=md-ellipsis> 13 Modeling contexts of use Contextual Representations and Pretraining </span> </a> </li> <li class=md-nav__item> <a href=../CS224n-2019-14-Transformers%20and%20Self-Attention%20For%20Generative%20Models/ class=md-nav__link> <span class=md-ellipsis> 14 Transformers and Self-Attention For Generative Models </span> </a> </li> <li class=md-nav__item> <a href=../CS224n-2019-15-Natural%20Language%20Generation/ class=md-nav__link> <span class=md-ellipsis> 15 Natural Language Generation </span> </a> </li> <li class=md-nav__item> <a href=../CS224n-2019-16-Coreference%20Resolution/ class=md-nav__link> <span class=md-ellipsis> 16 Coreference Resolution </span> </a> </li> <li class=md-nav__item> <a href=../CS224n-2019-17-Multitask%20Learning/ class=md-nav__link> <span class=md-ellipsis> 17 Multitask Learning </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id=__toc type=checkbox> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> 18 Tree Recursive Neural Networks, Constituency Parsing, and Sentiment </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 18 Tree Recursive Neural Networks, Constituency Parsing, and Sentiment </span> </a> <nav aria-label=目录 class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=#lecture-18-tree-recursive-neural-networks-constituency-parsing-and-sentiment> Lecture 18 Tree Recursive Neural Networks, Constituency Parsing, and Sentiment </a> <nav aria-label="Lecture 18 Tree Recursive Neural Networks, Constituency Parsing, and Sentiment" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#1-the-spectrum-of-language-in-cs> 1. The spectrum of language in CS </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#3-backpropagation-through-structure> 3. Backpropagation Through Structure </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#4-version-2-syntactically-untied-rnn> 4. Version 2: Syntactically-Untied RNN </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#5-qcd-aware-recursive-neural-networks-for-jet-physics> 5. QCD-Aware Recursive Neural Networks for Jet Physics </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#notes-09-recursive-neural-networks-and-constituency-parsing> Notes 09 Recursive Neural Networks and Constituency Parsing </a> <nav aria-label="Notes 09 Recursive Neural Networks and Constituency Parsing" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#1-recursive-neural-networks> 1 Recursive Neural Networks </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#11-a-simple-single-layer-rnn> 1.1 A simple single layer RNN </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#12-syntactically-untied-su-rnn> 1.2 Syntactically Untied SU-RNN </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#13-mv-rnns-matrix-vector-recursive-neural-networks> 1.3 MV-RNN’s (Matrix-Vector Recursive Neural Networks) </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#14-rntns-recursive-neural-tensor-network> 1.4 RNTNs (Recursive Neural Tensor Network) </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#2-constituency-parsing> 2 Constituency Parsing </a> <nav aria-label="2 Constituency Parsing" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#21-constituent> 2.1 Constituent </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#22-constituency-parse-tree> 2.2 Constituency Parse Tree </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#reference> Reference </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../CS224n-2019-19-Safety%2C%20Bias%2C%20and%20Fairness/ class=md-nav__link> <span class=md-ellipsis> 19 Safety, Bias, and Fairness </span> </a> </li> <li class=md-nav__item> <a href=../CS224n-2019-20-The%20Future%20of%20NLP%20%2B%20Deep%20Learning/ class=md-nav__link> <span class=md-ellipsis> 20 The Future of NLP + Deep Learning </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_5 type=checkbox> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex> <span class=md-ellipsis> Notes on MkDocs </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_5_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Notes on MkDocs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../MkDocs_demo/ class=md-nav__link> <span class=md-ellipsis> Demo </span> </a> </li> <li class=md-nav__item> <a href=../Material%20Theme%20Tutorial/ class=md-nav__link> <span class=md-ellipsis> Material Theme Tutorial </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav aria-label=目录 class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=#lecture-18-tree-recursive-neural-networks-constituency-parsing-and-sentiment> Lecture 18 Tree Recursive Neural Networks, Constituency Parsing, and Sentiment </a> <nav aria-label="Lecture 18 Tree Recursive Neural Networks, Constituency Parsing, and Sentiment" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#1-the-spectrum-of-language-in-cs> 1. The spectrum of language in CS </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#3-backpropagation-through-structure> 3. Backpropagation Through Structure </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#4-version-2-syntactically-untied-rnn> 4. Version 2: Syntactically-Untied RNN </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#5-qcd-aware-recursive-neural-networks-for-jet-physics> 5. QCD-Aware Recursive Neural Networks for Jet Physics </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#notes-09-recursive-neural-networks-and-constituency-parsing> Notes 09 Recursive Neural Networks and Constituency Parsing </a> <nav aria-label="Notes 09 Recursive Neural Networks and Constituency Parsing" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#1-recursive-neural-networks> 1 Recursive Neural Networks </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#11-a-simple-single-layer-rnn> 1.1 A simple single layer RNN </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#12-syntactically-untied-su-rnn> 1.2 Syntactically Untied SU-RNN </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#13-mv-rnns-matrix-vector-recursive-neural-networks> 1.3 MV-RNN’s (Matrix-Vector Recursive Neural Networks) </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#14-rntns-recursive-neural-tensor-network> 1.4 RNTNs (Recursive Neural Tensor Network) </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#2-constituency-parsing> 2 Constituency Parsing </a> <nav aria-label="2 Constituency Parsing" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#21-constituent> 2.1 Constituent </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#22-constituency-parse-tree> 2.2 Constituency Parse Tree </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#reference> Reference </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>18 Tree Recursive Neural Networks, Constituency Parsing, and Sentiment</h1> <h2 id=lecture-18-tree-recursive-neural-networks-constituency-parsing-and-sentiment>Lecture 18 Tree Recursive Neural Networks, Constituency Parsing, and Sentiment<a class=headerlink href=#lecture-18-tree-recursive-neural-networks-constituency-parsing-and-sentiment title="Permanent link">¶</a></h2> <p><strong>Lecture Plan</strong></p> <ol> <li>Motivation: Compositionality and Recursion</li> <li>Structure prediction with simple Tree RNN: Parsing</li> <li>Backpropagation through Structure</li> <li>More complex TreeRNN units (35 mins)</li> <li>Other uses of tree-recursive neural nets (5 mins)</li> <li>Institute for Human-Centered Artificial Intelligence</li> </ol> <h3 id=1-the-spectrum-of-language-in-cs>1. The spectrum of language in CS<a class=headerlink href=#1-the-spectrum-of-language-in-cs title="Permanent link">¶</a></h3> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723200753247.png><img alt=image-20190723200753247 src=../imgs/image-20190723200753247.png></a></p> <ul> <li>词袋模型 和 复杂形式的语言表达结构</li> </ul> <p><strong>Semantic interpretation of language – Not just word vectors</strong></p> <p>我们怎样才能弄清楚更大的短语的含义？</p> <ul> <li>The <strong>snowboarder</strong> is leaping over a mogul</li> <li>A <strong>person on a snowboard</strong> jumps into the air</li> </ul> <p>The <strong>snowboarder</strong> 在语义上相当于 A <strong>person on a snowboard</strong>，但它们的字长不一样</p> <ul> <li>人们之所以可以理解 A <strong>person on a snowboard</strong> ，是因为 <strong>the principle of compositionality</strong> 组合原则</li> <li>人们知道每个单词的意思，从而知道了 on a snowboard 的意思</li> <li>知道组件的含义并将他们组合成为更大的组件</li> </ul> <p>人们通过较小元素的<strong>语义成分</strong>来解释较大文本单元的意义 - 实体，描述性术语，事实，论点，故事</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723202652808.png><img alt=image-20190723202652808 src=../imgs/image-20190723202652808.png></a></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723202804492.png><img alt=image-20190723202804492 src=../imgs/image-20190723202804492.png></a></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723202830233.png><img alt=image-20190723202830233 src=../imgs/image-20190723202830233.png></a></p> <ul> <li>语言理解 - 和人工智能 - 需要能够通过了解较小的部分来理解更大的事物</li> </ul> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723202946203.png><img alt=image-20190723202946203 src=../imgs/image-20190723202946203.png></a></p> <ul> <li>我们拥有将较小的部分组合起来制作出更大东西的能力</li> </ul> <p><strong>Are languages recursive?</strong></p> <ul> <li>认知上有点争议（需要前往无限）</li> <li>但是：递归对于描述语言是很自然的<ul> <li>[The person standing next to [the man from [the company that purchased [the firm that you used to work at]]]]</li> <li>包含名词短语的名词短语，包含名词短语</li> </ul> </li> <li>它是语言结构的一个非常强大的先验</li> </ul> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723203243950.png><img alt=image-20190723203243950 src=../imgs/image-20190723203243950.png></a></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723203254802.png><img alt=image-20190723203254802 src=../imgs/image-20190723203254802.png></a></p> <p><strong>2. Building on Word Vector Space Models</strong></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723203632622.png><img alt=image-20190723203632622 src=../imgs/image-20190723203632622.png></a></p> <ul> <li>the country of my birth</li> <li>the place where I was born</li> <li>我们怎样表示更长短语的意思呢？</li> <li>通过将他们映射到相同的向量空间！</li> </ul> <p><strong>How should we map phrases into a vector space?</strong></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723203739983.png><img alt=image-20190723203739983 src=../imgs/image-20190723203739983.png></a></p> <ul> <li>基于组合原则，使用单词的含义和组合他们的规则，得到一个句子的含义向量</li> <li>同时学习解析树以及组合向量表示</li> </ul> <p><strong>Constituency Sentence Parsing: What we want</strong></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723204042599.png><img alt=image-20190723204042599 src=../imgs/image-20190723204042599.png></a></p> <p><strong>Learn Structure and Representation</strong></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723204054399.png><img alt=image-20190723204054399 src=../imgs/image-20190723204054399.png></a></p> <ul> <li>我们需要能够学习如何解析出正确的语法结构，并学习如何基于语法结构，来构建句子的向量表示</li> </ul> <p><strong>Recursive vs. recurrent neural networks</strong></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723204111837.png><img alt=image-20190723204111837 src=../imgs/image-20190723204111837.png></a></p> <ul> <li>递归神经网络需要一个树结构</li> <li>循环神经网络不能在没有前缀上下文的情况下捕捉短语，并且经常在最终的向量中过度捕捉最后一个单词</li> </ul> <p><strong>Recursive Neural Networks for Structure Prediction</strong></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723210220771.png><img alt=image-20190723210220771 src=../imgs/image-20190723210220771.png></a></p> <p>如果我们自上而下的工作，那么我们在底层有单词向量，所以我们想要递归地计算更大成分的含义</p> <p>输入：两个候选的子节点的表示</p> <p>输出：</p> <ul> <li>两个节点被合并后的语义表示</li> <li>新节点的合理程度</li> </ul> <p><strong>Recursive Neural Network Definition</strong></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723210810651.png><img alt=image-20190723210810651 src=../imgs/image-20190723210810651.png></a></p> <p><strong>Parsing a sentence with an RNN (greedily)</strong></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723211101549.png><img alt=image-20190723211101549 src=../imgs/image-20190723211101549.png></a></p> <p><strong>Parsing a sentence</strong></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723211120252.png><img alt=image-20190723211120252 src=../imgs/image-20190723211120252.png></a></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723211127883.png><img alt=image-20190723211127883 src=../imgs/image-20190723211127883.png></a></p> <ul> <li>自左向右重复遍历，每次将得分最高的两者组合在一起</li> </ul> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723211341754.png><img alt=image-20190723211341754 src=../imgs/image-20190723211341754.png></a></p> <p><strong>Max-Margin Framework - Details</strong></p> <ul> <li>树的得分是通过每个节点的解析决策得分的总和来计算的：</li> </ul> <div class=arithmatex>\[ s(x, y)=\sum_{n \in n o d e (y)} s_{n} \]</div> <ul> <li> <p>x 是句子，y 是解析树</p> </li> <li> <p>类似于最大边距解析（Taskar et al.2004），一个受监督的最大边际目标</p> </li> </ul> <div class=arithmatex>\[ J=\sum_{i} s\left(x_{i}, y_{i}\right)-\max _{y \in A\left(x_{i}\right)}\left(s\left(x_{i}, y\right)+\Delta\left(y, y_{i}\right)\right) \]</div> <ul> <li>损失 <span class=arithmatex>\(\Delta\left(y, y_{i}\right)\)</span> 惩罚所有不正确的决策</li> <li>结构搜索 <span class=arithmatex>\(A(x)\)</span> 是贪婪的（每次加入最佳节点）<ul> <li>相反：使用 Beam search 搜索图</li> </ul> </li> </ul> <p><strong>Scene Parsing</strong></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723211834904.png><img alt=image-20190723211834904 src=../imgs/image-20190723211834904.png></a></p> <p>和组合类似的准则</p> <ul> <li>场景图像的含义也是较小区域的函数</li> <li>它们如何组合成部分以形成更大的对象</li> <li>以及对象如何相互作用</li> </ul> <p><strong>Algorithm for Parsing Images</strong></p> <p>Same Recursive Neural Network as for natural language parsing! (Socher et al. ICML 2011)</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723211912327.png><img alt=image-20190723211912327 src=../imgs/image-20190723211912327.png></a></p> <p><strong>Multi-class segmentation</strong></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723211955217.png><img alt=image-20190723211955217 src=../imgs/image-20190723211955217.png></a></p> <h3 id=3-backpropagation-through-structure>3. Backpropagation Through Structure<a class=headerlink href=#3-backpropagation-through-structure title="Permanent link">¶</a></h3> <p>Introduced by Goller &amp; Küchler (1996)</p> <p>和通用的反向传播的规则相同 $$ \delta<sup _l_=(l)>{(l)}=\left(\left(W</sup>\right)^{T} \delta^{(l+1)}\right) \circ f<sup _l_=(l)>{\prime}\left(z</sup>\right), \quad \quad \quad \frac{\partial}{\partial W^{(l)}} E_{R}=\delta<sup _l_=(l)>{(l+1)}\left(a</sup>\right)^{T}+\lambda W^{(l)} $$ 递归和树结构导致的计算：</p> <ol> <li>从所有节点（如RNN）求和W的导数</li> <li>在每个节点处拆分导数（对于树）</li> <li>从父节点和节点本身添加错误消息</li> </ol> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723213338143.png><img alt=image-20190723213338143 src=../imgs/image-20190723213338143.png></a></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723213412307.png><img alt=image-20190723213412307 src=../imgs/image-20190723213412307.png></a></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723213419949.png><img alt=image-20190723213419949 src=../imgs/image-20190723213419949.png></a></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723213427994.png><img alt=image-20190723213427994 src=../imgs/image-20190723213427994.png></a></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723213440154.png><img alt=image-20190723213440154 src=../imgs/image-20190723213440154.png></a></p> <p><strong>Discussion: Simple TreeRNN</strong></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723213632964.png><img alt=image-20190723213632964 src=../imgs/image-20190723213632964.png></a></p> <ul> <li>使用单矩阵TreeRNN的结果</li> <li>单个权重矩阵TreeRNN可以捕获一些现象但不适合更复杂的现象以及更高阶的构成和解析长句</li> <li>输入词之间没有真正的交互</li> <li>组合函数对于所有句法类别，标点符号等都是相同的</li> </ul> <h3 id=4-version-2-syntactically-untied-rnn>4. Version 2: Syntactically-Untied RNN<a class=headerlink href=#4-version-2-syntactically-untied-rnn title="Permanent link">¶</a></h3> <p>[Socher, Bauer, Manning, Ng 2013]</p> <ul> <li>符号的上下文无关的语法（Context Free Grammar CFG）主干是足以满足基本的句法结构</li> <li>我们使用子元素的离散句法类别来选择组合矩阵</li> <li>对于不同的语法环境，TreeRNN可以针对不同的组合矩阵做得更好</li> <li>结果为我们提供了更好的语义</li> </ul> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723213747321.png><img alt=image-20190723213747321 src=../imgs/image-20190723213747321.png></a></p> <ul> <li>左边 RNN 是使用概率的上下文无关的语法解析，为句子生成可能的树结构</li> <li>右边 SU-RNN 是语法解开的递归神经网络，此时每个节点和序列都有一个类别，我们可以使用对应不同类别的矩阵组合起来，例如将类别 B 和类别 C 的矩阵组合起来作为本次计算的权重矩阵，所以这个权重矩阵是更符合句子结构的</li> </ul> <p><strong>Compositional Vector Grammars</strong></p> <ul> <li>问题：速度。Beam search 中的每个候选分数都需要一次矩阵向量乘法</li> <li>解决方案：仅针对来自更简单，更快速模型(Probabilistic Context Free Grammar (PCFG))的树的子集计算得分</li> <li> <ul> <li>修剪非常不可能的速度候选人</li> <li>为每个 beam 候选者提供子句的粗略语法类别</li> </ul> </li> <li>组合矢量语法= PCFG + TreeRNN</li> </ul> <p><strong>Related Work for parsing</strong></p> <ul> <li>产生的 CVG Parser 与以前扩展PCFG解析器的工作有关</li> <li>Klein and Manning (2003a)：手工特征工程</li> <li>Petrov et al. (2006)：分解和合并句法类别的学习算法</li> <li>词汇化解析器(Collins, 2003; Charniak, 2000)：用词汇项描述每个类别</li> <li>Hall and Klein (2012) 在一个因式解析器中结合了几个这样的注释方案</li> <li>CVGs 将这些想法从离散表示扩展到更丰富的连续表达</li> </ul> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723214625943.png><img alt=image-20190723214625943 src=../imgs/image-20190723214625943.png></a></p> <p><strong>SU-RNN / CVG [Socher, Bauer, Manning, Ng 2013]</strong></p> <p>Learns soft notion of head words</p> <p>初始化：<span class=arithmatex>\(W^{(\cdot)}=0.5\left[I_{n \times n} I_{n \times n} 0_{n \times 1}\right]+\epsilon\)</span></p> <ul> <li>初始化为一对对角矩阵</li> <li>学习的是一个短语中哪个子节点是重要的</li> </ul> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723225439148.png><img alt=image-20190723225439148 src=../imgs/image-20190723225439148.png></a></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723225455054.png><img alt=image-20190723225455054 src=../imgs/image-20190723225455054.png></a></p> <p><strong>Analysis of resulting vector representations</strong></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723231938212.png><img alt=image-20190723231938212 src=../imgs/image-20190723231938212.png></a></p> <p>所有数据均根据季节变化进行调整</p> <ol> <li>所有数字都根据季节性波动进行调整</li> <li>调整所有数字以消除通常的季节性模式</li> </ol> <p>Knight-Ridder不会评论这个提议</p> <ol> <li> <p>Harsco declined to say what country placed the order</p> </li> <li> <p>Coastal wouldn’t disclose the terms</p> </li> </ol> <p>Sales grew almost 7% to <span class=arithmatex>\(\text{\$UNK m.}\)</span> from <span class=arithmatex>\(\text{\$UNK m.}\)</span></p> <ol> <li>Sales rose more than 7% to $94.9 m. from $88.3 m.</li> <li>Sales surged 40% to UNK b. yen from UNK b.</li> </ol> <p><strong>Version 3: Compositionality Through Recursive Matrix-Vector Spaces</strong></p> <p>[Socher, Huval, Bhat, Manning, &amp; Ng, 2012]</p> <ul> <li>之前：<span class=arithmatex>\(p=\tanh \left(W\left[\begin{array}{l}{c_{1}} \\ {c_{2}}\end{array}\right]+b\right)\)</span> ，<span class=arithmatex>\(c_1\)</span> 和 <span class=arithmatex>\(c_2\)</span> 之间并没有相互影响</li> <li>使组合函数更强大的一种方法是解开权重 W</li> <li>但是，如果单词主要作为运算符，例如 “very” in “very good”，是没有意义的，是用于增加 good 的规模的运算符</li> <li>提案：新的组合函数</li> <li>问题是如何定义呢，因为不知道 <span class=arithmatex>\(c_1\)</span> 和 <span class=arithmatex>\(c_2\)</span> 哪个是 operator，比如 very good ，就应该讲 very 视为作用在 good 的矩阵上的向量</li> </ul> <p><strong>Compositionality Through Recursive Matrix-Vector Recursive Neural Networks</strong></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723233237337.png><img alt=image-20190723233237337 src=../imgs/image-20190723233237337.png></a></p> <ul> <li>每个单词都拥有一个向量意义和一个矩阵意义</li> </ul> <p><strong>Matrix-vector RNNs</strong></p> <p>[Socher, Huval, Bhat, Manning, &amp; Ng, 2012]</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723233308456.png><img alt=image-20190723233308456 src=../imgs/image-20190723233308456.png></a></p> <ul> <li>左侧计算得到合并后的向量意义</li> <li>右侧计算得到合并后的矩阵意义</li> <li>可以捕获运算符语义，即中一个单词修饰了另一个单词的含义 </li> </ul> <p><strong>Predicting Sentiment Distributions</strong></p> <p>语言中非线性的好例子</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723233404570.png><img alt=image-20190723233404570 src=../imgs/image-20190723233404570.png></a></p> <p><strong>Classification of Semantic Relationships</strong></p> <ul> <li>MV-RNN 可以学习到大的句法上下文传达语义关系吗？</li> <li><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723233544007.png><img alt=image-20190723233544007 src=../imgs/image-20190723233544007.png></a></li> <li>为包括两项的最小成分构建单个组合语义</li> </ul> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723233633217.png><img alt=image-20190723233633217 src=../imgs/image-20190723233633217.png></a></p> <ul> <li>问题：参数量过大，并且获得短语的矩阵意义的方式不够好</li> </ul> <p><strong>Version 4: Recursive Neural Tensor Network</strong></p> <p>Socher, Perelygin, Wu, Chuang, Manning, Ng, and Potts 2013</p> <ul> <li>比 MV-RNN 更少的参数量</li> <li>允许两个单词或短语向量乘法交互</li> </ul> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723233736108.png><img alt=image-20190723233736108 src=../imgs/image-20190723233736108.png></a></p> <p><strong>Beyond the bag of words: Sentiment detection</strong></p> <p>一段文字的语调是积极的，消极的还是中性的？</p> <ul> <li>某种程度上情绪分析是容易的</li> <li>较长文档的检测精度~90％，但是</li> </ul> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723233854256.png><img alt=image-20190723233854256 src=../imgs/image-20190723233854256.png></a></p> <p><strong>Stanford Sentiment Treebank</strong></p> <ul> <li>215,154 phrases labeled in 11,855 sentences</li> <li>可以真的训练和测试组合</li> </ul> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724011526347.png><img alt=image-20190724011526347 src=../imgs/image-20190724011526347.png></a></p> <p><a href=http://nlp.stanford.edu:8080/sentiment/ >http://nlp.stanford.edu:8080/sentiment/</a></p> <p><strong>Better Dataset Helped All Models</strong></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723233943541.png><img alt=image-20190723233943541 src=../imgs/image-20190723233943541.png></a></p> <ul> <li>严重的否定的案例仍然大多判断错误的</li> <li>我们还需要一个更强大的模型！</li> </ul> <p>想法：允许载体的加性和介导的乘法相互作用</p> <ul> <li>在树中使用结果向量作为逻辑回归的分类器的输入</li> <li>使用梯度下降联合训练所有权重</li> </ul> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723234308688.png><img alt=image-20190723234308688 src=../imgs/image-20190723234308688.png></a></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723234516105.png><img alt=image-20190723234516105 src=../imgs/image-20190723234516105.png></a></p> <ul> <li>回到最初的使用向量表示单词的意义，但不是仅仅将两个表示单词含义的向量相互作用，左上图是在中间插入一个矩阵，以双线性的方式做注意力并得到了注意力得分。即令两个单词的向量相互作用并且只产生一个数字作为输出</li> <li>如上中图所示，我们可以拥有三维矩阵，即多层的矩阵（二维），从而得到了两个得分</li> <li>使用 softmax 做分类</li> </ul> <p><strong>Positive/Negative Results on Treebank</strong></p> <p>Classifying Sentences: Accuracy improves to 85.4</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723234538696.png><img alt=image-20190723234538696 src=../imgs/image-20190723234538696.png></a></p> <p><strong>Experimental Results on Treebank</strong></p> <ul> <li>RNTN 可以捕捉类似 X but Y 的结构</li> <li>RNTN accuracy of 72%, compared to MV-RNN (65%), biword NB (58%) and RNN (54%)</li> </ul> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723234948091.png><img alt=image-20190723234948091 src=../imgs/image-20190723234948091.png></a></p> <p><strong>Negation Results</strong></p> <p>双重否定时，积极反应应该上升</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723235028044.png><img alt=image-20190723235028044 src=../imgs/image-20190723235028044.png></a></p> <ul> <li>Demo: <a href=http://nlp.stanford.edu:8080/sentiment/ >http://nlp.stanford.edu:8080/sentiment/</a></li> </ul> <p><strong>Version 5: Improving Deep Learning Semantic Representations using a TreeLSTM</strong></p> <p>[Tai et al., ACL 2015; also Zhu et al. ICML 2015]</p> <p>目标：</p> <ul> <li>仍试图将句子的含义表示为（高维，连续）向量空间中的位置</li> <li>一种准确处理语义构成和句子含义的方式</li> <li>将广泛使用的链式结构LSTM推广到树结构</li> </ul> <p><strong>Long Short-Term Memory (LSTM) Units for Sequential Composition</strong></p> <p>门是 <span class=arithmatex>\([0,1]^{d}\)</span> 的向量，用于逐元素乘积的软掩蔽元素</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190723235452810.png><img alt=image-20190723235452810 src=../imgs/image-20190723235452810.png></a></p> <p><strong>Tree-Structured Long Short-Term Memory Networks</strong> </p> <p>[Tai et al., ACL 2015]</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724000330382.png><img alt=image-20190724000330382 src=../imgs/image-20190724000330382.png></a></p> <p><strong>Tree-structured LSTM</strong></p> <p>将连续LSTM推广到具有任何分支因子的树</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724000401880.png><img alt=image-20190724000401880 src=../imgs/image-20190724000401880.png></a></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724000419835.png><img alt=image-20190724000419835 src=../imgs/image-20190724000419835.png></a></p> <p><strong>Results: Sentiment Analysis: Stanford Sentiment Treebank</strong></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724000445664.png><img alt=image-20190724000445664 src=../imgs/image-20190724000445664.png></a></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724000453862.png><img alt=image-20190724000453862 src=../imgs/image-20190724000453862.png></a></p> <p><strong>Results: Semantic Relatedness SICK 2014 (Sentences Involving Compositional Knowledge)</strong></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724000529369.png><img alt=image-20190724000529369 src=../imgs/image-20190724000529369.png></a></p> <p><strong>Forget Gates: Selective State Preservation</strong></p> <p>Stripes = forget gate activations; more white ⇒ more preserved</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724000554468.png><img alt=image-20190724000554468 src=../imgs/image-20190724000554468.png></a></p> <h3 id=5-qcd-aware-recursive-neural-networks-for-jet-physics>5. QCD-Aware Recursive Neural Networks for Jet Physics<a class=headerlink href=#5-qcd-aware-recursive-neural-networks-for-jet-physics title="Permanent link">¶</a></h3> <p>Gilles Louppe, Kyunghun Cho, Cyril Becot, Kyle Cranmer (2017)</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724000622396.png><img alt=image-20190724000622396 src=../imgs/image-20190724000622396.png></a></p> <p><strong>Tree-to-tree Neural Networks for Program Translation</strong></p> <p>[Chen, Liu, and Song NeurIPS 2018]</p> <ul> <li>探索在编程语言之间使用树形结构编码和生成进行翻译</li> <li>在生成中，将注意力集中在源树上</li> </ul> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724000854873.png><img alt=image-20190724000854873 src=../imgs/image-20190724000854873.png></a></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724000949587.png><img alt=image-20190724000949587 src=../imgs/image-20190724000949587.png></a></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724000959596.png><img alt=image-20190724000959596 src=../imgs/image-20190724000959596.png></a></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724001019745.png><img alt=image-20190724001019745 src=../imgs/image-20190724001019745.png></a></p> <p><strong>Human-Centered Artificial Intelligence</strong></p> <ul> <li>人工智能有望改变经济和社会，改变我们沟通和工作的方式，重塑治理和政治，并挑战国际秩序</li> <li>HAI的使命是推进人工智能研究，教育，政策和实践，以改善人类状况</li> </ul> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724001122663.png><img alt=image-20190724001122663 src=../imgs/image-20190724001122663.png></a></p> <h2 id=notes-09-recursive-neural-networks-and-constituency-parsing>Notes 09 Recursive Neural Networks and Constituency Parsing<a class=headerlink href=#notes-09-recursive-neural-networks-and-constituency-parsing title="Permanent link">¶</a></h2> <p><strong>Note</strong>: "RNN" in this set of notes refers to Recursive Neural Networks, not Recurrent Neural Networks. The former is a superset of the latter.</p> <h4 id=1-recursive-neural-networks>1 Recursive Neural Networks<a class=headerlink href=#1-recursive-neural-networks title="Permanent link">¶</a></h4> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724200605764.png><img alt=image-20190724200605764 src=../imgs/image-20190724200605764.png></a></p> <p>在这些笔记中，我们介绍并讨论了一种新的模型，它是之前讨论过的递归神经网络的超集。递归神经网络(RNNs 如上图所示)非常适合具有嵌套层次结构和内在递归结构的设置。如果我们思考一个句子，它不是正是有这样的结构吗？以“A small crowd quietly enters the historical church”为例。首先，我们将句子分成名词短语、动词短语、“A small crowd”和“quietly enters the historical church”。但是有一个名词短语在动词短语中:“quietly enters”和“historical church”，等等。这看起来确实很递归。</p> <p>“语言的语法规则是高度递归的。因此，我们使用一个利用了递归结构的模型。使用 RNN建模句子的另一个好处是我们现在可以输入任意长度的句子，这是一个巨大的头脑在NLP使用神经网络和非常聪明的技巧使句子的输入向量相等尺寸相同，尽管句子的长度不相等。(see Bengio et al., 2003; Henderson, 2003; Collobert &amp; Weston, 2008)</p> <p>假设我们的任务是取一个句子，并将其表示为与单词本身语义空间相同的向量。所以像“I went to the mall yesterday”、“We went shopping last week”和“They went to the store”这样的短语，彼此之间的距离都非常近。我们已经看到了训练单字向量的方法，我们是否应该对二元组、三元组等也做同样的事情。这可能非常有效，但这种想法存在两个主要问题。1) 单词的组合有无数种可能。存储和训练无限数量的向量将是荒谬的。2) 有些单词的组合虽然在语言中完全可以听到，但可能永远不会出现在我们的 训练 / 开发 语料库中，所以我们永远学不会。</p> <p>我们需要一种方法来取一个句子及其相应的词向量，并推导出嵌入向量应该是什么。现在让我们先问一个非常有争议的问题。我们用来表示所有单词的向量空间，具有足够的表达能力以至于能够表示任意长度的所有句子，这是天真的想法吗？虽然这可能是不直观的，但这些模型的性能表明，这实际上是一件合理的事情。</p> <p>我们先来讨论一下句子的语义理解和语法理解的区别。语义分析是对句子意义的理解，能够在结构语义空间中把短语表示为一个向量，相似的句子非常近，不相关的句子非常远。语法理解是指我们已经确定了句子的基本语法结构，句子的哪一部分取决于哪一部分，哪些词在修饰哪些词，等等。这种理解的输出通常用解析树表示，如下图所示。</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724200615930.png><img alt=image-20190724200615930 src=../imgs/image-20190724200615930.png></a></p> <p>现在，让我们来看看最重要的问题。如果我们想要知道语义的表达方式，是否需要有语法上的理解？有些人可能不同意，但现在我们将用下面的方法来处理这个语义组合任务。首先，我们需要理解单词。然后，我们需要知道单词是如何组合在一起的，然后，最后，我们可以通过利用前面的两个概念得到一个短语或句子的意思。</p> <p>让我们从我们的第一个基于这个原则的模型开始。假设我们有一个句子，我们知道这个句子的解析树，如上图所示，我们能找出这个句子的编码吗？也许还能从句子中的单词向量中得到一个情感得分？我们观察一个简单的RNN是如何完成这项任务的。”</p> <h4 id=11-a-simple-single-layer-rnn>1.1 A simple single layer RNN<a class=headerlink href=#11-a-simple-single-layer-rnn title="Permanent link">¶</a></h4> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724203302710.png><img alt=image-20190724203302710 src=../imgs/image-20190724203302710.png></a></p> <p>让我们浏览一下上图中显示的模型。我们首先获取一个句子解析树和句子单词向量，然后开始遍历该树。图中最低的节点是 <span class=arithmatex>\(\text{Node}_3\)</span> ，所以我们将 <span class=arithmatex>\(L_{29}\)</span> 和 <span class=arithmatex>\(L_{430}\)</span> 连接起来形成一个向量 <span class=arithmatex>\(\in \mathbb{R}^{2 d}\)</span> ，并将其输入到我们的网络中进行计算： $$ h^{(1)}=\tanh \left(W^{(1)}\left[\begin{array}{c}{L_{29}} \ {L_{430}}\end{array}\right]+b^{(1)}\right) $$ 考虑到 <span class=arithmatex>\(W^{(1)} \in \mathbb{R}^{d \times 2 d} \text { and } b^{(1)} \in \mathbb{R}^{d}, h^{(1)} \in \mathbb{R}^{d}\)</span> ，我们现在可以将 <span class=arithmatex>\(h^{(1)}\)</span> 看做是 bigram “this assignment” 的相同单词向量空间的一个点，我们不需要分别学习表示，而是从其构成的单词向量中派生。</p> <p>我们现在将 <span class=arithmatex>\(h^{(1)}\)</span> 投进一个 softmax 层中来获得一个情感类别的分数，情感类别是一个已知的代表一些含义的离散集合。在积极/消极情绪分析的情况下，我们会有5个类，类0表示强烈的消极，类1表示消极，类2表示中性，类3表示积极，最后类4表示强烈的积极。</p> <p>现在我们对“I”和“love”做同样的处理，生成短语“I love”的向量 <span class=arithmatex>\(h^{(1)}\)</span> 。同样，我们计算该短语在情感类上的得分。最后，最有趣的一步，我们需要合并两个短语“I love”和“this assignment”。这里我们连接的是单词短语，而不是单词向量！我们用同样的方法，把两个 <span class=arithmatex>\(h^{(1)}\)</span> 连接起来并且计算 $$ h^{(1)}=\tanh \left(W^{(1)}\left[\begin{array}{c}{h_{L e f t}^{(1)}} \ {h_{R i g h t}<sup _1_=(1)>{(1)}}\end{array}\right]+b</sup>\right) $$ 现在我们有一个向量在向量空间中表示完整的句子”I love this assignment”。此外，我们可以将这个 <span class=arithmatex>\(h^{(1)}\)</span> 通过与前面相同的 softmax 层，并计算整个句子的情绪概率。当然，模型只有在经过训练后才能可靠地做到这一点。</p> <p>现在让我们后退一步。首先，认为我们可以使用相同的矩阵 <span class=arithmatex>\(W\)</span> 将所有单词连接在一起，得到一个非常有表现力的 <span class=arithmatex>\(h^{(1)}\)</span> ，然后再次使用相同的矩阵 <span class=arithmatex>\(W\)</span> 将所有短语向量连接起来，得到更深层的短语，这样的想法是不是太天真了？这些批评是合理的，我们可以通过下面对简单RNN的处理来解决它们。</p> <h4 id=12-syntactically-untied-su-rnn>1.2 Syntactically Untied SU-RNN<a class=headerlink href=#12-syntactically-untied-su-rnn title="Permanent link">¶</a></h4> <p>正如我们在前一节的批评中所讨论的，使用相同的 $W $ 将名词短语和动词短语组合在一起，将介词短语和另一个词向量组合在一起，从直觉上看似乎是错误的。也许我们是直接将所有这些功能合并到一个太弱的模型中。</p> <p>我们能做的就是“从语法上解开”这些不同任务的权重。我们的意思是，没有理由期望某一类输入的最优 <span class=arithmatex>\(W\)</span> 与另一类输入的最优 <span class=arithmatex>\(W\)</span> 完全相关。所以我们让这些 <span class=arithmatex>\(W\)</span> 不一样，放松这个约束。虽然这确实增加了我们要学习的权重矩阵，但是我们获得的性能提升却不是微不足道的。</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724204658961.png><img alt=image-20190724204658961 src=../imgs/image-20190724204658961.png></a></p> <p>对不同类别的输入使用不同的 <span class=arithmatex>\(W\)</span> 比对所有类别只使用一个 <span class=arithmatex>\(W\)</span> 更自然</p> <p>正如上图所示，我们注意到我们的模型现在取决于输入的语法类别。注意，我们通过一个非常简单的概率上下文自由语法(PCFG)来确定类别，这个语法或多或少是通过计算Penn Tree Bank上的汇总统计信息来学习的，以学习规则，比如“the”总是一个DT等等。不需要对这部分有更深的理解，只需要知道它非常简单。</p> <p>这个模型中唯一的其他主要区别是，我们根据语言类别分别初始化了 <span class=arithmatex>\(W\)</span> 。这样做的默认做法是对输入的两个单词向量求平均值。缓慢但肯定的是，模型会学会哪个向量更重要，以及向量的任何旋转或缩放都可以提高性能。我们在下图中观察到，经过训练的权重矩阵学习了实际意义！例如，DT-NP 规则，或者说是限定词后跟名词短语 (如“The car”或“A man”) 的例子中，更强调名词词组。(这是显而易见的，因为右边的对角线是红色的，表示更高的权重)。这被称为soft head words 的概念，语言学家们长期以来一直认为这是正确的，然而这个模型仅仅通过观察数据就学会了这一点。很酷！</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724205546044.png><img alt=image-20190724205546044 src=../imgs/image-20190724205546044.png></a></p> <p>学习到的 DT-NP 组合的权重 <span class=arithmatex>\(W\)</span> 符合语言学理论</p> <p>SU-RNN确实比之前讨论过的模型表现得更好，但也许它的表现力还不够。如果我们考虑修饰词，比如副词“very”，任何与这个单词向量和下面这个单词向量的插值，肯定不是我们所理解的“very”的本质。。</p> <p>作为副词，它的字面意思是“用于强调”。当我们只做线性插值时，我们怎么能得到一个强调其他向量的向量呢？我们如何构造一个向量，它将以这种方式“缩放”任何其他向量？事实是我们不能。我们需要一个词对另一个词的乘法。我们在下面发现了两个这样的组合，它们可以实现这一点。第一个利用单词矩阵，另一个利用二次方程的典型仿射。</p> <h4 id=13-mv-rnns-matrix-vector-recursive-neural-networks>1.3 MV-RNN’s (Matrix-Vector Recursive Neural Networks)<a class=headerlink href=#13-mv-rnns-matrix-vector-recursive-neural-networks title="Permanent link">¶</a></h4> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724211212052.png><img alt=image-20190724211212052 src=../imgs/image-20190724211212052.png></a></p> <p>我们现在扩大我们的单词表示，不仅包括一个单词向量，而且还包括一个单词矩阵！所以单词“very”将有一个单词向量 <span class=arithmatex>\(v_{v e r y} \in \mathbb{R}^{d}\)</span> ，和单词矩阵 <span class=arithmatex>\(V_{v e r y} \in \mathbb{R}^{d \times d}\)</span> 。这让我们不仅能够表达一个单词的意思，还能学习单词“modify 修饰”其他单词的方式。单词矩阵指的就是后者。为了将两个单词 <span class=arithmatex>\(a\)</span> 和 <span class=arithmatex>\(b\)</span> 输入RNN，我们取它们的单词矩阵 <span class=arithmatex>\(A\)</span> 和 <span class=arithmatex>\(B\)</span> ，形成输入向量 <span class=arithmatex>\(x\)</span>，作为向量<span class=arithmatex>\(Ab\)</span>和<span class=arithmatex>\(Ba\)</span>的组合。在我们的“very”例子中，<span class=arithmatex>\(V_{very}\)</span>可以是单位矩阵乘以任意大于1的标量。它可以将任何相邻的词向量乘以这个数！这正是我们所需要的那种表示能力。当新的单词表示开拓了我们的特征空间时，我们可以更好地表达单词彼此修饰的方式。</p> <p>通过对模型误差的观察，我们发现即使是MV- RNN也不能表达一定的关系。我们观察到三大类错误。</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724211735838.png><img alt=image-20190724211735838 src=../imgs/image-20190724211735838.png></a></p> <p>第一，Negated Positives 否定积极。当我们说一些积极的东西，但一个词变成了消极的，模型不能衡量一个词强大到足以翻转整个句子的情绪。上图显示了这样一个例子，将单词“most”转换为“least”应该会翻转整个句子的情绪，但是MV-RNN没有成功地捕捉到这一点。</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724211748129.png><img alt=image-20190724211748129 src=../imgs/image-20190724211748129.png></a></p> <p>第二类错误是 Negated Negative 否定的否定形式。我们说某事不坏，或者不枯燥，如上图所示。MV-RNN不能识别出“not”这个词会使情绪从消极变为中性。</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724211836961.png><img alt=image-20190724211836961 src=../imgs/image-20190724211836961.png></a></p> <p>我们观察到的最后一类错误是上图中显示的“X but Y连接词”。这里的 X 可能是负的，但如果Y是正的，那么模型对句子的情感输出应该是正的！MV-RNNs正在与之斗争。</p> <p>因此，我们必须寻找一种更富表现力的组合算法，能够完全捕捉这些类型的高级构成。</p> <h4 id=14-rntns-recursive-neural-tensor-network>1.4 RNTNs (Recursive Neural Tensor Network)<a class=headerlink href=#14-rntns-recursive-neural-tensor-network title="Permanent link">¶</a></h4> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724212235558.png><img alt=image-20190724212235558 src=../imgs/image-20190724212235558.png></a></p> <p>我们将在这里讨论的最后一个RNN是迄今为止在我们所总结的三种错误类型中效果最成功的。递归神经张量网络 Recursive Neural Tensor Network 消除了单词矩阵的概念，进一步消除了传统仿射变换的 pre-tanh/sigmoid 的概念。为了组合两个单词向量或短语向量，我们再次将它们连接起来，形成一个向量<span class=arithmatex>\(\in \mathbb{R}^{2 d}\)</span>，但是我们没有先将其放入仿射函数，然后是一个非线性的，而是先将其放入一个二次方程，然后是一个非线性的，比如： $$ h^{(1)}=\tanh \left(x^{T} V x+W x\right) $$ 这里，<span class=arithmatex>\(V\)</span> 是一个三阶张量 <span class=arithmatex>\(\mathbb{R}^{2 d \times 2 d \times d}\)</span>，我们计算 <span class=arithmatex>\(x^{T} V[i] x, \forall i \in[1,2, \ldots d]\)</span> 张量的切片输出向量<span class=arithmatex>\(\mathbb{R}^{d}\)</span>。然后我们加上<span class=arithmatex>\(Wx\)</span>，把它变成一个非线性函数。二次方显示了乘法，我们确实可以使得词向量之间进行乘法交互，而不需要维护和学习单词矩阵！</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724213119112.png><img alt=image-20190724213119112 src=../imgs/image-20190724213119112.png></a></p> <p>如上图所示，RNTN是唯一能够在这些非常难的数据集上成功的模型。</p> <p>之前的笔记中讨论过的卷积神经网络(CNN) 在某些方面优于RNTN，并且不需要输入解析树!”</p> <h3 id=2-constituency-parsing>2 Constituency Parsing<a class=headerlink href=#2-constituency-parsing title="Permanent link">¶</a></h3> <p>自然语言理解要求能够从较大的文本单元中较小的部分的理解中提取意义。这种提取要求能够理解较小的部件是如何组合在一起的。分析句子句法结构的方法主要有两种：<strong>constituency parsing</strong> and <strong>dependency parsing</strong> 成分句法分析和依存分析。依存分析在前几节课中已经讨论过(参见Note04)。通过在单词及其依赖项之间建立二进制非对称关系，结构显示了哪个单词依赖于哪个单词。现在我们关注成分句法分析，它将单词组织成嵌套的成分。</p> <p>成分句法分析是将一段文本(例如一个句子)分成子短语的一种方法。成分句法分析(也称为“短语结构分析”)的目标之一是识别文本中的成分，这些成分在从文本中提取信息时非常有用。通过分析句子后了解成分，就有可能生成语法上正确的类似句子。</p> <h4 id=21-constituent>2.1 Constituent<a class=headerlink href=#21-constituent title="Permanent link">¶</a></h4> <p>在句法分析中，一个成分可以是一个单词或短语，作为一个层次结构中的一个单元。短语是由两个或两个以上的单词组成的词组，围绕 a head lexical item 一个词首词项，在一个句子中作为一个单位使用。作为一个短语，一组词应该在句子中发挥特定的作用。此外，一组词可以一起移动或替换为一个整体，句子应该保持流利和语法。</p> <p>我们用较小元素的符号组合来解释大的文本单元。这些较小的元素可以在保持相同含义的同时进行更改，如下面的示例所示。</p> <p>例如，下面的句子包含名词短语：wonderful CS224N”</p> <ul> <li>I want to be enrolled in the wonderful CS224N!</li> </ul> <p>我们通过移动整个短语到最前面来重写这个句子</p> <ul> <li>The wonderful CS224N I want to be enrolled in</li> </ul> <p>或者这个短语可以被一个类似功能和意义的成分所替代，例如"great CS course in Stanford about NLP and Deep Learning”</p> <ul> <li>I want to be enrolled in the great CS course in Stanford about NLP and Deep Learning!</li> </ul> <p>对于成分句法分析，基本子句结构被理解为，子句分为主语(名词短语NP)和谓语(动词短语VP)的二元划分，表达如下规则。子句的二元划分导致一对一或一对多通信。对于句子中的每个元素，树结构中都有一个或多个节点。</p> <ul> <li><span class=arithmatex>\(\mathrm{S} \rightarrow \mathrm{NP} \quad \mathrm{VP}\)</span></li> </ul> <p>事实上，解析的过程说明了某些类似的规则。我们从句子符号 S 开始推导规则，依次对短语结构规则进行叠加，最后应用替代规则来使用抽象符号代替实际单词。根据提取规则，可以生成相似的句子。如果规则正确，那么以这种方式产生的任何句子都应该在语法上正确。然而，生成的句子在语法上可能是正确的，但在语义上却是荒谬的，比如下面这个众所周知的例子:</p> <ul> <li>Colorless green ideas sleep furiously</li> </ul> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724214558934.png><img alt=image-20190724214558934 src=../imgs/image-20190724214558934.png></a></p> <h4 id=22-constituency-parse-tree>2.2 Constituency Parse Tree<a class=headerlink href=#22-constituency-parse-tree title="Permanent link">¶</a></h4> <p>有趣的是，在自然语言中，这些成分很可能彼此嵌套在一起。因此，这些短语的自然表示形式是树。通常我们使用成分解析树来演示解析过程。基于结构语法的成分解析树可以区分终端节点和非终端节点。树中的非终结符被标记为短语的类型(例如名词短语)，终结符是句子中的准确单词。以 “John hit the ball” 为例，英语句子的句法结构如下图所示。</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../imgs/image-20190724214753107.png><img alt=image-20190724214753107 src=../imgs/image-20190724214753107.png></a></p> <p>我们有一个解析树，从表示整个句子的根S开始，到表示句子中的每个单词的每个叶子节点结束。我们使用以下缩写：</p> <ul> <li>S 代表句子，最高级的结构</li> <li>NP 代表名词短语，包括句子的主语和宾语</li> <li>VP 代表动词短语，充当谓语</li> <li>V 代表动词</li> <li>D 代表限定词，例如 “the”</li> <li>N 代表名词</li> </ul> <p>注意：回到句子表示，如果你不知道解析树呢？我们在这一系列课堂笔记中观察到的RNNs依赖于这样的初始解析。如果我们使用的是递归神经网络，而这个短语的上下文在它的右边会怎样？如果我们只在最后一个时间步上应用Softmax，那么最后几个字将对输出产生不成比例的大影响，例如，分类。卷积神经网络解决了这个问题，正如之前的讲义所述。</p> <h2 id=reference>Reference<a class=headerlink href=#reference title="Permanent link">¶</a></h2> <p>以下是学习本课程时的可用参考书籍：</p> <p><a href=https://item.jd.com/12355569.html>《基于深度学习的自然语言处理》</a> （车万翔老师等翻译）</p> <p><a href=https://nndl.github.io/ >《神经网络与深度学习》</a></p> <p>以下是整理笔记的过程中参考的博客：</p> <p><a href=https://zhuanlan.zhihu.com/p/59011576>斯坦福CS224N深度学习自然语言处理2019冬学习笔记目录</a> (课件核心内容的提炼，并包含作者的见解与建议)</p> <p><a href=https://zhuanlan.zhihu.com/p/31977759>斯坦福大学 CS224n自然语言处理与深度学习笔记汇总</a> <span class="critic comment">这是针对note部分的翻译</span></p> </article> </div> </div> <button class="md-top md-icon" data-md-component=top hidden type=button> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg> 回到页面顶部 </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright © 2019 - 2022; Xiao Xu </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs </a> </div> <div class=md-social> <a class=md-social__link href=https://github.com/looperXX rel=noopener target=_blank title=github.com> <svg viewbox="0 0 480 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg> </a> <a class=md-social__link href=https://twitter.com/looperxx_nlp rel=noopener target=_blank title=twitter.com> <svg viewbox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg> </a> <a class=md-social__link href=https://www.linkedin.com/in/%E5%95%B8-%E5%BE%90-012456163/ rel=noopener target=_blank title=www.linkedin.com> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "content.tooltips", "navigation.indexes", "navigation.tracking", "navigation.sections", "navigation.tabs", "navigation.top", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.a264c092.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script> <script src=../../assets/javascripts/bundle.726fbb30.min.js></script> <script src=../../javascripts/baidu-tongji.js></script> <script src=../../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body> </html>